<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nota Fiscal - HortiSystem</title>
    <style>
        /* ESTILOS DE NOTA FISCAL */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Courier New', monospace;
            background: white;
            padding: 20px;
            max-width: 400px;
            margin: 0 auto;
        }
        .nota-fiscal {
            border: 2px solid black;
            padding: 15px;
        }
        .header { text-align: center; margin-bottom: 15px; }
        .header h1 { font-size: 18px; margin-bottom: 5px; }
        .linha {
            border-bottom: 1px dashed #000;
            margin: 8px 0;
            padding-bottom: 8px;
        }
        .linha-dupla { border-bottom: 2px solid #000; }
        .item { display: flex; justify-content: space-between; }
        .total { font-weight: bold; font-size: 18px; text-align: right; }
        .rodape { text-align: center; margin-top: 20px; font-size: 12px; }
        .btn-print {
            display: block;
            width: 100%;
            padding: 10px;
            background: #2e7d32;
            color: white;
            border: none;
            margin-top: 15px;
            cursor: pointer;
        }
    </style>
</head>
<body>
<div class="nota-fiscal" id="notaFiscal">
    <div class="header">
        <h1>HORTISYSTEM SUPERMERCADO</h1>
        <p>CNPJ: 12.345.678/0001-90</p>
        <p>Rua das Hortali√ßas, 123 - Centro</p>
    </div>

    <div class="linha">
        <strong>NOTA FISCAL</strong><br>
        N¬∫: <span th:text="${venda.numeroNotaFiscal}"></span><br>
        Data: <span th:text="${#temporals.format(venda.dataVenda, 'dd/MM/yyyy HH:mm')}"></span>
    </div>

    <div class="linha">
        <strong>CLIENTE:</strong><br>
        <span th:text="${venda.nomeCliente}"></span><br>
        <span th:text="${venda.cpfCliente} ?: 'CPF n√£o informado'"></span>
    </div>

    <div class="linha">
        <strong>ITENS:</strong>
        <div th:each="item : ${venda.itens}" class="item">
            <span th:text="${item.produto.nome}"></span>
            <span th:text="${item.quantidade} + ' x R$ ' + ${#numbers.formatDecimal(item.valorUnitario, 1, 2, 'POINT')}"></span>
        </div>
    </div>

    <div class="linha-dupla">
        <div class="item">
            <span>TOTAL DE ITENS:</span>
            <span th:text="${venda.quantidadeTotalItens}"></span>
        </div>
        <div class="item">
            <span>FORMA PAGAMENTO:</span>
            <span th:text="${venda.formaPagamento}"></span>
        </div>
        <div class="item" th:if="${venda.formaPagamento == 'DINHEIRO'}">
            <span>VALOR RECEBIDO:</span>
            <span th:text="'R$ ' + ${#numbers.formatDecimal(venda.valorRecebido, 1, 2, 'POINT')}"></span>
        </div>
        <div class="item" th:if="${venda.formaPagamento == 'DINHEIRO'}">
            <span>TROCO:</span>
            <span th:text="'R$ ' + ${#numbers.formatDecimal(venda.troco, 1, 2, 'POINT')}"></span>
        </div>
    </div>

    <div class="total">
        TOTAL: R$ <span th:text="${#numbers.formatDecimal(venda.valorTotal, 1, 2, 'POINT')}"></span>
    </div>

    <div class="rodape">
        <p>*** OBRIGADO PELA PREFER√äNCIA ***</p>
        <p>Volte Sempre!</p>
        <p>HORTISYSTEM - QUALIDADE EM HORTIFRUTI</p>
    </div>
</div>

<button class="btn-print" onclick="window.print()">üñ®Ô∏è IMPRIMIR NOTA FISCAL</button>
<a href="/caixa" style="display: block; text-align: center; margin-top: 10px;">üîÑ NOVA VENDA</a>

<script>
    // Imprime automaticamente (opcional)
    // window.onload = function() { window.print(); };

    console.log('üìÑ Nota fiscal gerada com sucesso!');
</script>
</body>
</html>